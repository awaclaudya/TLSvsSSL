package tls_client;
import javax.net.ssl.SSLSocket;
import javax.net.ssl.SSLSocketFactory;
import java.io.*;
public class JavaTLSClientExample {
private static final String[] protocols = {"TLSv1.3"};
private static final String[] cipher_suites = {"TLS_AES_128_GCM_SHA256"};
public static void main(String[] args) {
SSLSocket socket = null;
 PrintWriter out = null;
 BufferedReader in = null;
 try {
 // 1. O bt m f brica padr o de sockets SSL
 SSLSocketFactory factory = (SSLSocketFactory) SSLSocketFactory.getDefault();
 // 2. Cria socket conectado ao google.com na porta 443
 socket = (SSLSocket) factory.createSocket("google.com", 443);
 // 3. F or a uso exclusivo do TLS 1.3
 socket.setEnabledProtocols(protocols);
 // 4. Restringe cipher suite mais segura do TLS 1.3
 socket.setEnabledCipherSuites(cipher_suites);
 // 5. Inicia handshake explicitamente
 socket.startHandshake();
 // 6. Prepara streams de s a d a
 out = new PrintWriter(
 new BufferedWriter(
 new OutputStreamWriter(
 socket.getOutputStream())));
 // 7. Envia r e q u i s i o HTTP simples
 out.println("GET / HTTP/1.0");
 out.println();
 out.flush();
 if (out.checkError()) {
 System.out.println("SSLSocketClient: java.io.PrintWriter error");
 }
 // 8. L resposta do servidor
 in = new BufferedReader(
 new InputStreamReader(
 socket.getInputStream()));
 String inputLine;
 while ((inputLine = in.readLine()) != null) {
 System.out.println(inputLine);
 }
 } catch (Exception e) {
 e.printStackTrace();
 } finally {
 // 9. Fecha recursos de forma segura
 try { if (socket != null) socket.close(); } catch (Exception e) {}
 try { if (out != null) out.close(); } catch (Exception e) {}
 try { if (in != null) in.close(); } catch (Exception e) {}
 }
 }
 }